import Ball from "./modules/Ball";
import Mouse from "./modules/mouse";

const canvas = document.getElementById('canvas') as HTMLCanvasElement;
const ctx = canvas.getContext('2d');
const mousePos = new Mouse(canvas);
const mouseCursor = new Ball(0, 0, 20, 'rgba(0,0,0,0)')
let balls = [];
let coords = [
  319.0009088602868,56.12314272305253,317.3233229324303,75.70870970879713,302.19216258165875,88.19113565016828,283.2414477229181,94.53071957213929,263.72862825646735,98.938640772155,244.06863488207279,102.59453752557783,224.35854869772447,105.91158443727772,204.6004105156169,109.05138213742337,184.66958125835808,110.68218457369532,164.69728349564832,110.13223938015582,144.86295718605325,107.60815646022954,125.33851160613577,103.31553658144168,106.22867851415343,97.43238010443669,87.62861254932274,90.10228334083287,69.6135310907767,81.41691870069218,52.29366280154767,71.41798660719635,35.838182419751384,60.06990198211346,20.551066441422947,47.175469395833076,7.327763816937766,32.2168007418357,0.9183711185056265,13.761711661489127,16.91358223044893,4.6537102231497895,36.87957979623375,5.057760611947161,56.82644986154516,6.609391071006338,76.77447551491692,8.041069214890594,96.75663627594713,8.909560480766757,116.75021880917413,8.979865649109993,136.73606783478763,8.099154304310131,156.64307297114712,6.159089511910059,176.42983144358732,3.3233420083200387,196.3304400914444,1.3722596095681188,216.33139561879284,0.8738718598486663,236.2771019218785,2.1165963527550504,255.98903626521115,5.474876653210503,275.04814216127807,11.421343311709542,292.79727049057,20.57180950940301,307.8947691062207,33.597533036686585,317.7604152779358,50.825711694353465
]

for (let i = 0; i < coords.length; i += 2) {
  console.log(coords[i], coords[i + 1])
  balls.push(
    new Ball(
      coords[i] + 20,
      coords[i + 1] + 20,
    )
  )
}

function connectDots(balls) {
  ctx.beginPath();

  for (let i = 0, jlen = balls.length; i <= jlen; ++i) {
    let p0 = balls[i + 0 >= jlen ? i + 0 - jlen : i + 0];
    let p1 = balls[i + 1 >= jlen ? i + 1 - jlen : i + 1];
    ctx.quadraticCurveTo(p0.x, p0.y, (p0.x + p1.x) * 0.5, (p0.y + p1.y) * 0.5);
  }

  ctx.closePath();
  ctx.fillStyle = 'rgb(247, 48, 15)';
  ctx.fill();
}

// for (let i = 0; i < 600; i++) {
//   balls.push(
//     new Ball(
//       Math.random() * 600,
//       Math.random() * 600,
//     )
//   )
// }

function render() {
  requestAnimationFrame(render);
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  mouseCursor.setPos(mousePos.x, mousePos.y);
  mouseCursor.draw(ctx);
  balls.forEach(ball => {
    ball.think(mousePos.x, mousePos.y, mouseCursor.radius);
    // ball.draw(ctx);
  });
  connectDots(balls);
}

render();
